\chapter{Problem formulation}

This chapter gives a short overview of the classical RMDP from \cite{UlmerRMDP} and the RMDPEAT introduced in \cite{Hildebrandt2020_EAT} and then formulates the EAT component in detail. The RMDPEAT combines the RMDP with arrival time estimation and hence accounts for both processes. 
\section{Restaurant Meal Delivery Problem with Arrival Time Estimation}
According to the Dynamic vehicle routing taxonomy introduced in \cite{psaraftis} which helps us to embed the RMDP into the broader context of dynamic vehicle routing problems, the classical RMDP belongs to the category of dynamic (1) and stochastic (2) problems since (1) drivers routes need to be reoptimized over time by means of a routing policy and (2) only the probability distributions of inputs are known at the start of the problem respectively. In the RMDP, customers are distributed across a known service area and request service during a finite service time window. Drivers distributed in the service area are dispatched by a meal delivery platform providing meal delivery service to participating restaurants. The RMDP process is triggered with the arrival of customer requests. When a customer requests service on the meal delivery platform, a driver according to the assignment policy proposed in \cite{UlmerRMDP}. Since it is assumed that drivers are in no contractual relationship with the dispatcher, drivers get to decide how orders are sequenced and routed and thus, the routing policy is exogenously given. Overall, the RMDP seeks maximization in the amount of served customers and minimization in delivery delays. Keep in mind that order bundling is allowed. Order bundling refers to the possibility of assigning a vehicle more than one order at a time which results in greater flexibility in assignment and routing decisions.

The classical RMDP assumes that planned arrival times are the result of assump-tions made by the dispatcher. In contrast to \citet{UlmerRMDP}, \citet{Hildebrandt2020_EAT} account for arrival time estimations in their problem by providing customers requesting service on the platform estimated arrival times for each listed restaurant. That way, customers are given the choice to either order from a prefered restaurant if the arrival time expectations are met, or do not order at all. As we already pointed out in the very beginning, this is crucial as there is evidence of arrival delay having a negative impact on customer satisfaction. 

\section{Estimating arrival times for delivery routing}

\cite{Hildebrandt2020_EAT} define the RMDPEAT as a dynamic decision process. Based on that, they further formulate the problem of estimating arrival times for delivery routing (EAT), which is just the EAT part of the RMDPEAT process, formally and in detail as well. In the following, we recap their EAT formulation formally since we operate on the same underlying DVR problem setting and share a the same task in predicting arrival times, but keep our explanations concise. For a full explanation for the EAT, the interested reader is referred to section 3.2 in \cite{Hildebrandt2020_EAT}. 

Let $ c_k $ denote the k-th customer requesting service at time point $ t_k $, $ \mathcal{N}_k $ the set of customers that have requested service but have not been served yet, $ R_k $ the set of restaurants, and $ \Theta_k $ the set of planned routes for each driver at decision epoch $ k $. The decision state for the RMDPEAT is therefore given as $ S_k = (t_k, \mathcal{N}_k \cup c_k, \mathcal{R}_k, \Theta_k) $. Decision points are triggered when customers request service and happen in two stages: First, potential routing decisions $ \Theta_{ik} $ for every restaurant $ i = 1, \dots, |\mathcal{R}_k| $ the customer can order from are computed. The union of the RMDPEAT state $ S_k $ with these potential routing decisions $ \Theta_{ik} $ represents the EAT state $ S^{EAT}_k := (S_k \cup \Theta_{ik})$. Second, arrival time decisions $ X(S^{EAT}_k) := (X_{ik})_{i = 1, \dots, |\mathcal{R}_k|}$ are computed for the corresponding routing decisions $ \Theta_{ik} $, i.e. the estimated arrival times for each restaurant. The objective of the EAT is then defined as
\begin{equation}\label{equation:3.1}
	\min_{X(S^{EAT}_k)(j) \in \mathbb{R}_+} 
	\mathbb{E}_{S^{EAT}_{k}} 
	(|| A(S^{EAT}_{k})(j) - X(S^{EAT}_{k})(j)||^{2}_{2}).
\end{equation}
Equation \ref{equation:3.1} seeks to minimize the deviance of the estimated arrival time $ X(S^{EAT}_{k})(j) $ from the actual arrival time $ A(S^{EAT}_{k})(j) $ for the customer's restaurant choice $ j $.

%A decision epoch $ k $ occurs whenever a customer requests arrival times, in other words requests delivery. 
%State $ S_k = (t_k, \mathcal{N}_k \cup c_k, \mathcal{R}_k, \Theta_k)$ contains the time point of the request $ t_k $, the set of customers $ \mathcal{N_k} $ that have requested service but have not been served yet plus the customer that requests service at time $ t_k $, the restaurants and their workloads $ \mathcal{R}_k $ described by a location, the queue of requested meals to prepare and the preparation start time, and the set of planned routes $ \Theta_k $ given by a sequence of pickup and delivery actions which in turn are given by an origin, destination, the time when the pickup or delivery action is started and the duration of the action. 
%A decision determines the set of planned routes $ \Theta_{ik} $ first and then estimates arrival times $ X_{ik} := X (S_k \cup \Theta_{ik}) \in \mathbb{R}$ for each restaurant $ i = 1, \dots, |\mathcal{R}_k| $. 
%Transition of state $ S_k $ to the state at the next decision epoch $ S_{k+1} $ is then realized when a routing decision is made and the customer $ c_k $ makes his restaurant choice at time $ t_k $. 
%State transitions result in updated planned routes $ \Theta_{k+1} $ given by $ \Theta_k $ ex pickup and delivery actions carried out between $ t_k $ and $ t_{k+1} $. 
%Following sources of uncertainty impact the RMDPEAT process: 
%(1) Customers are unknown until they request service, (2) meal preparation times of restaurants, 
%(3) parking and delivery times of drivers, and 
%(4) the restaurant choice of customer $ c_k $ determined by an individual preference function $ \Phi_k((X_{ik})_{i \in \{1,\dots, R_k\}}) $ which receives a vector of corresponding arrival times for each restaurant as input, and returns the customers restaurant choice.
%Thus, the routing decision itself is uncertain due to (1), realization of pickup and delivery actions is uncertain due to (2) and (3), and restaurant workloads are uncertain due to (3) and (4). 
%$ \mathcal{N}_{k+1} $ depends on all four sources of uncertainty and the routing decision.
%Last but not least, the RMDP seeks to maximize the number of served customers within the service horizon and minimize delays of predicted arrival times wrt. actual arrival times. Latter is the focus of \cite{Hildebrandt2020_EAT} and therefore also the focus of this work.

























































































    